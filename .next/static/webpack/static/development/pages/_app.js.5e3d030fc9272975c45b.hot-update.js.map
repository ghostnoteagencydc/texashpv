{"version":3,"file":"static/webpack/static/development/pages/_app.js.5e3d030fc9272975c45b.hot-update.js","sources":["webpack:///./pages/_app.js"],"sourcesContent":["import React from 'react'\nimport Header from '../components/header'\nimport App, { Container } from 'next/app'\nimport fetch from 'isomorphic-unfetch'\nimport _Cookies from '../utilities/cookies_functions'\n\nimport '../components/shared.css'\n\nclass MyApp extends App {\n  constructor() {\n    super()\n    this.state = {\n      userToken: '',\n      isLoggedIn: false,\n      loginErrorMessage: ''\n    }\n    this.getLogin = this.getLogin.bind(this)\n  }\n  static async getInitialProps({ Component, ctx }) {\n    let pageProps = {}\n\n    if (Component.getInitialProps) {\n      pageProps = await Component.getInitialProps(ctx)\n    }\n    const res = await fetch(\n      'https://hpvtexas.wpengine.com/wp-json/better-rest-endpoints/v1/pages'\n    )\n    const menu = await fetch(\n      'https://hpvtexas.wpengine.com/wp-json/better-rest-endpoints/v1/menus/main'\n    )\n    const data = await res.json()\n    const menudata = await menu.json()\n\n    return { pageProps: pageProps, menudata: menudata }\n  }\n\n  componentDidMount() {\n    let token = _Cookies.getCookie('hpv_usertoken39200')\n    if (token) {\n      this.setstate = {\n        userToken: token,\n        isLoggedIn: true\n      }\n      console.log(token)\n    } else {\n      console.log('cookie not found with token')\n    }\n  }\n\n  async getUserInfo(token) {\n    const rawResponse = await fetch(\n      'https://hpvtexas.wpengine.com/wp-json/wp/v2/users/me',\n      {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          username: user,\n          password: pass\n        })\n      }\n    )\n    const res = await rawResponse.json()\n  }\n\n  async getLogin(user, pass) {\n    const rawResponse = await fetch(\n      'https://hpvtexas.wpengine.com/wp-json/jwt-auth/v1/token',\n      {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username: user,\n          password: pass\n        })\n      }\n    )\n    const res = await rawResponse.json()\n    if (!res.data || !res.data.status) {\n      this.setState({\n        userToken: res.token,\n        isLoggedIn: true\n      })\n      _Cookies.setCookie('hpv_usertoken39200', res.token, 30)\n    } else if (res.message) {\n      console.log(res.message)\n      this.setState({\n        loginErrorMessage: res.message\n      })\n    }\n    console.log(res)\n  }\n\n  render() {\n    const { Component, pageProps } = this.props\n    return (\n      <Container>\n        <Header menudata={this.props.menudata} />\n        <Component\n          {...pageProps}\n          getLogin={this.getLogin}\n          loginData={{\n            isLoggedIn: this.state.isLoggedIn,\n            userToken: this.state.userToken,\n            loginErrorMessage: this.state.loginErrorMessage\n          }}\n        />\n      </Container>\n    )\n  }\n}\n\nexport default MyApp\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAPA;AAQA;AACA;;;AAkBA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;;;;;;AAEA;;;;;;;AACA;AAGA;AACA;AACA;AADA;AAGA;AACA;AACA;AAFA;AALA;AACA;;AAHA;;AAaA;AACA;;AADA;AACA;;;;;;;;;;;;;;;;;;;;AAEA;;;;;;;AACA;AAGA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AANA;AACA;;AAHA;;AAcA;AACA;;AADA;AACA;AAAA;AACA;AACA;AACA;AAFA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;;;;;;;;;;;;;;;;;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AAHA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;;;;;;;;;;;;AA/FA;AACA;AACA;AACA;;;;;;AACA;AACA;;AADA;AACA;;;AACA;AACA;;AADA;;AAGA;AACA;;AADA;;AAGA;AACA;;AADA;;AACA;AACA;;AADA;AAEA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;AA1BA;AACA;AA2GA;;;;A","sourceRoot":""}